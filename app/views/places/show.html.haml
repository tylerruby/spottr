.container-fluid
  .row{:style => "margin-top:20px;"}
    .col-md-4.col-md-offset-1.col-sm-5.col-xs-12
      .panel.panel-default
        .panel-body{:style => "padding:0;"}
          .row
            .col-md-6.col-xs-6
              = image_tag @place.image.url(:thumb), class: 'img-responsive'
            .col-md-5
              %h4
                - href = "http://maps.google.com/?saddr=#{@lat},#{@long}&daddr=#{@place.latitude},#{@place.longitude}"
                %a.btn.btn-sm.btn-default.btn-outline.fa.fa-car.pull-right{:href=> href, :target => "_blank"}
                = @place.title.classify
              = @place.address
      .panel.panel-default
        .panel-body{:style => "padding:0;"}
          .row
            .col-md-12.hidden-xs
              #place-map{style: "height: 400px;"}
              :javascript
                function init() {
                  var currentLatLng = new google.maps.LatLng(#{@lat}, #{@long});
                  var latLng = new google.maps.LatLng(#{@place.latitude}, #{@place.longitude});
                  var mapOptions = {
                    center: latLng,
                    zoom: 14
                  }
                  var map = new google.maps.Map(document.getElementById('place-map'),
                    mapOptions);
                  var marker = new google.maps.Marker({
                    position: latLng,
                    map: map,
                    title: "#{@place.title}"
                  });
                }
                google.maps.event.addDomListener(window, 'load', init);
      .panel.panel-default
        .panel-body{:style => "padding:4px;"}
          - @place.votes.includes(:voter).order("created_at DESC").limit(21).each do |p|
            = link_to p.voter do
              = image_tag p.voter.image.url(:small), style: "margin-top: 5px"
    .col-md-6.col-sm-7.col-xs-12
      .panel.panel-default.map-control-panel
        .panel-heading
          .row
            .col-md-12
              = render 'shared/controls/time_mode_select'
        .panel-body
          %table.table
            %tbody
    .col-md-6.col-sm-7.col-xs-12
      .panel.panel-default.map-control-panel#comments-panel
        .panel-heading
          .row
            .col-md-12
              = render 'shared/controls/time_mode_select'
              %button.btn.btn-default.btn-outline New
        .panel-body{:style => "padding-top:0px;"}
          %table.table.js-dynamic-table
            %tbody
              - if @place.comments.count == 0
                %tr
                  %td{colspan: 3}
                    %em.text-grey No comments yet
              - @place.comments.each do |comment|
                %tr
                  %td{:style => "border-top:none;"}
                    - upvoted_class = comment.voted_by?(current_user) ? "upvoted" : ""
                    %a.js-upvote.btn.btn-sm.btn-default.glyphicon.glyphicon-chevron-up{href: up_vote_place_comment_url(@place, comment), class: upvoted_class}
                      = comment.votes.count
                  %td{:style => "border-top:none;"}
                    %strong= comment.user.email
                  %td{:style => "border-top:none;"}= comment.comment
        - if user_signed_in?
          = form_for [@place, Comment.new], html: {class: 'form'} do |f|
            .form-group.col-md-10.col-md-offset-1
              = f.text_area :comment, placeholder: "Type comment here", class: 'form-control'
            .form-group
              = f.submit "Comment", class: 'btn btn-primary btn-outline col-md-offset-9 col-sm-offset-7'
            .clearfix
